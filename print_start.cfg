[gcode_macro PRINT_START]
gcode:
    {% set bed_temp = params.BED|default(110)|float %}
    {% set extruder_temp = params.EXTRUDER|default(245)|float %}
    {% set retract = 10 %}
    SET_FAN_SPEED FAN=chamber_fan SPEED=1
    G28                            ; home all axes
    G90
    M83
    G1 Z20 F3000                   ; move nozzle away from bed
    M140 S{bed_temp}               ; Start heating bed
    M190 S{bed_temp}               ; Wait for bed to reach temperature
    M109 S{extruder_temp}          ; Set and wait for nozzle to reach temperature
    BED_MESH_CALIBRATE
    INTRO_LINE                     ; Prime the nozzle with an intro line

[gcode_macro INTRO_LINE]
gcode:
    M117 Intro Line...
    G90                            ; Use absolute coordinates
    M83
    G92 E0
    G1 X40 Y115 Z5 F6000             ; Move the nozzle to the front and near the bed
    G1 Z0.7 F300                   ; Move the nozzle very close to the bed
    G1 E4 F900                     ; extrude retract
    G1 X80 E10.0 F500.0            ; intro line
    G1 E-0.5 F1000
    G92 E0.0                       ; set extruder posion to 0
    G1 X94 Z1 F6000                   ; move away from intro line
    M117
